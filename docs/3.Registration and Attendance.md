# College Management App - Documentation
## Part 3: Registration & Attendance System

---

## 1. Registration System Overview

### 1.1 Introduction

The Registration System handles the complete process of event sign-ups, from initial registration through confirmation and cancellation. It ensures smooth user experience while providing organizers with tools to manage participant lists efficiently.

The system supports various registration modes including instant confirmation, approval-based registration, and waitlist management. All registration actions trigger appropriate notifications and update real-time availability counters.

### 1.2 Registration Types

| Type | Description | Use Case |
|------|-------------|----------|
| Instant | Immediate confirmation upon registration | Most events, workshops, seminars |
| Approval-Based | Requires organizer approval | Competitive events, limited capacity workshops |
| Waitlist | Join queue when event is full | Popular events with high demand |
| First-Come-First-Serve | Based on registration timestamp | Events with strict capacity limits |
| Priority | Early access for specific groups | Club members, department students |

---

## 2. Registration Data Model

### 2.1 Firestore Registration Document Structure

```
registrations/{registrationId}
  - registrationId: string (auto-generated)
  - eventId: string (reference to event)
  - userId: string (reference to user)
  - userDetails: object
      - name: string
      - email: string
      - department: string
      - year: number
      - phoneNumber: string
  - registrationDate: timestamp
  - registrationStatus: string (pending/confirmed/waitlisted/cancelled/rejected)
  - approvalStatus: string (pending/approved/rejected) // if approval required
  - approvalDate: timestamp
  - approvedBy: string (userId of approver)
  - rejectionReason: string (if rejected)
  - customFormResponses: object // responses to custom registration fields
      - fieldId: string
      - fieldName: string
      - response: any (string/number/array)
  - attendanceStatus: object
      - isPresent: boolean
      - checkInTime: timestamp
      - checkInMethod: string (qr/manual)
      - checkedInBy: string (userId)
  - certificateGenerated: boolean
  - certificateUrl: string
  - notificationsSent: object
      - confirmation: boolean
      - reminder24h: boolean
      - reminder1h: boolean
      - eventUpdate: boolean
  - cancellationDetails: object
      - cancelledAt: timestamp
      - cancelledBy: string (user/organizer/system)
      - reason: string
  - waitlistPosition: number (if waitlisted)
  - priorityRegistration: boolean
  - source: string (browse/search/notification/share)
  - createdAt: timestamp
  - updatedAt: timestamp
```

### 2.2 Registration Status Flow

```
Registration Submitted
         ↓
    [If Instant]     [If Approval Required]
         ↓                    ↓
     Confirmed           Pending Approval
         ↓                    ↓
         |              [Approved/Rejected]
         ↓                    ↓
    Active Registration   Confirmed/Rejected
         ↓
    [Event Day]
         ↓
    Attendance Marked
         ↓
    Certificate Issued
```

**Special Cases**:
- If event is full → Waitlisted status
- If user cancels → Cancelled status
- If event cancelled → All registrations cancelled
- If waitlist user promoted → Confirmed status

---

## 3. Registration Process

### 3.1 User Registration Flow

#### Step 1: Accessing Registration

From the event details screen, users tap the "Register Now" button. The system first checks user authentication status. Unauthenticated users are prompted to login or create an account. The app then verifies event eligibility based on target audience criteria.

#### Step 2: Registration Eligibility Check

The system performs several validation checks:

**Event Status Validation**
- Event must be published (not draft or cancelled)
- Registration must be open (within registration timeline)
- Event date must be in the future

**Capacity Validation**
- Check if seats are available
- If full, check if waitlist is enabled
- Calculate real-time availability

**User Eligibility Validation**
- Verify user matches target audience (department, year)
- Check if user already registered for this event
- Validate user account status (active, not suspended)

**Conflict Detection**
- Check for time conflicts with other registered events
- Warn user if another event overlaps (soft warning, not blocking)

#### Step 3: Registration Form

If the event has custom registration fields, the form displays with all required and optional fields:

**Pre-filled Information**
- Name, email, department, year (from user profile)
- Phone number (if available in profile)

**Custom Fields** (as defined by organizer)
- Text inputs with validation
- Dropdown selections
- Multiple choice options
- File uploads (if required)
- Radio buttons for single selection

**Terms and Conditions**
- Event-specific rules or requirements
- Cancellation policy
- Attendance requirements
- Checkbox for acceptance (mandatory)

#### Step 4: Submission and Confirmation

User taps "Submit Registration" button. The app performs final validation of all fields. If validation passes, the registration is submitted to Firestore through a Cloud Function to ensure data integrity and atomic operations.

**Immediate Actions**:
- Registration document created in Firestore
- User's registrations collection updated
- Event's current registration count incremented
- Confirmation notification sent to user
- Confirmation email triggered (if email service enabled)

**User Feedback**:
- Success message with registration ID
- "View Registration" button to see details
- "Add to Calendar" quick action
- "Share" option to tell friends

### 3.2 Registration Confirmation

#### Confirmation Notification

Users receive immediate in-app and push notifications confirming registration. The notification includes event name, date, time, venue, and a QR code ticket link.

#### Confirmation Email

An automated email sends with comprehensive details:
- Event information and poster
- Registration confirmation number
- QR code for check-in (embedded image)
- Venue details with directions link
- Organizer contact information
- "Add to Calendar" file attachment (.ics format)
- Cancellation instructions and deadline

#### Registration Ticket

Users can access their digital ticket from "My Registrations" section. The ticket displays:
- QR code (unique registration ID encoded)
- Event details
- Venue information
- Attendance status indicator
- Download ticket as PDF option

---

## 4. Waitlist Management

### 4.1 Joining Waitlist

When an event reaches maximum capacity, the "Register" button changes to "Join Waitlist" (if enabled). Users can join the waitlist by completing the same registration form. Waitlist registrations create documents with "waitlisted" status and receive a position number.

#### Waitlist Notification

Waitlisted users receive notification confirming their position. The message includes current waitlist position, estimated chances of confirmation based on historical data, and instructions for when they might be promoted.

### 4.2 Waitlist Promotion

#### Automatic Promotion

When a confirmed participant cancels, the system automatically promotes the first waitlist user:

**Step 1**: Detect cancellation and seat availability

**Step 2**: Retrieve first waitlist user (lowest position number)

**Step 3**: Send promotion notification with 24-hour confirmation deadline

**Step 4**: Update registration status to "pending_confirmation"

**Step 5**: If user confirms within 24 hours, convert to "confirmed"

**Step 6**: If user doesn't respond, move to next waitlist user and reset deadline

#### Manual Promotion

Organizers can manually select waitlist users to promote through the event management dashboard. This is useful when adding capacity or giving priority to specific users. Manual promotions bypass the automatic queue order.

### 4.3 Waitlist Position Updates

Users receive notifications when their waitlist position changes. The app shows real-time position updates in the "My Registrations" section. Position improvements trigger encouraging notifications like "You've moved up to position 5!"

---

## 5. Registration Management

### 5.1 Viewing Registrations

#### User's Registration Dashboard

The "My Registrations" section shows all user's event registrations categorized by status:

**Upcoming Events** (default tab)
- Confirmed registrations for future events
- Sorted by event date
- Shows countdown to event
- Quick actions: View ticket, Add to calendar, Cancel registration

**Waitlisted Events**
- Events where user is on waitlist
- Displays current position
- Estimated promotion probability

**Past Events**
- Completed events with attendance status
- Certificate download if available
- Event feedback option

**Cancelled Registrations**
- History of cancelled registrations
- Cancellation date and reason

#### Organizer's Registration Dashboard

Organizers access detailed participant lists from event management screen:

**All Registrations View**
- Complete list with search and filter
- Columns: Name, Department, Registration Date, Status
- Sort by any column
- Export to CSV/Excel option

**Confirmed Participants**
- Only users with confirmed status
- Send bulk messages option
- Mark all as attended option

**Pending Approvals** (if approval-based)
- Applications requiring review
- Quick approve/reject actions
- View custom form responses

**Waitlist Queue**
- Ordered list of waitlisted users
- Promote to confirmed option
- Notify specific waitlist positions

**Cancelled Registrations**
- Historical record of cancellations
- Useful for analyzing drop-off patterns

### 5.2 Registration Cancellation

#### User-Initiated Cancellation

Users can cancel their registration from "My Registrations" or event details screen. The cancellation flow requires confirmation to prevent accidental cancellations.

**Cancellation Policy Display**:
- Shows cancellation deadline if applicable
- Warns if cancellation affects certificate eligibility
- Displays any applicable penalties

**Cancellation Process**:
1. User taps "Cancel Registration"
2. Confirmation dialog with reason dropdown (optional)
3. System validates cancellation eligibility (before deadline)
4. Registration status updated to "cancelled"
5. Event capacity counter decremented
6. If waitlist exists, first user automatically promoted
7. Cancellation confirmation sent to user
8. Organizer receives notification (for attendance planning)

#### Organizer-Initiated Cancellation

Organizers can remove participants through the dashboard. This requires selecting a reason from predefined options (policy violation, duplicate registration, no-show history, etc.). The affected user receives immediate notification with the reason for removal.

#### Bulk Cancellation

If an event is cancelled, all confirmed registrations are automatically cancelled. The system sends immediate notifications to all participants explaining the cancellation. Organizers must provide a cancellation reason that's shared with all registered users.

### 5.3 Registration Modification

Users can edit their registration details before the event (if organizer allows modifications). Editable fields include custom form responses, phone number, and emergency contact. Core details like name and email cannot be changed to maintain registration integrity.

---

## 6. Attendance Tracking System

### 6.1 QR Code-Based Check-In

#### QR Code Generation

Each registration generates a unique QR code encoding the registration ID. The QR code is accessible from the user's ticket in "My Registrations". Users can download tickets as PDF or save the QR code image locally.

#### QR Code Scanner

Organizers and designated volunteers access the QR scanner from the event management screen. The scanner opens the device camera with a targeting frame. When a QR code is scanned, the system instantly validates and marks attendance.

**Scan Validation**:
- Verify QR code format and authenticity
- Check if registration ID exists
- Confirm registration is for the current event
- Validate user is not already checked in
- Verify event is currently ongoing

**Successful Scan**:
- Attendance marked immediately
- Check-in timestamp recorded
- Audio/visual confirmation (beep, green checkmark)
- Participant name displayed for verification
- Counter updates showing total attendees

**Failed Scan**:
- Error message explaining issue (invalid code, wrong event, duplicate check-in)
- Audio/visual alert (error beep, red X)
- Option to manual check-in

#### Offline Check-In Support

The scanner works offline by caching the registration list before the event. Check-ins are stored locally and synced to Firestore when connection is restored. This ensures smooth check-in even with poor internet connectivity at venues.

### 6.2 Manual Attendance Marking

#### Manual Check-In Interface

If QR scanning fails or users forget tickets, organizers can manually mark attendance through a searchable participant list. The interface shows all confirmed registrations with attendance status indicators.

**Manual Check-In Process**:
1. Organizer searches by name, roll number, or email
2. Select correct participant from results
3. Verify identity (optional photo display)
4. Tap "Mark Present" button
5. Attendance recorded with "manual" check-in method
6. Optional note field for special circumstances

#### Bulk Attendance Marking

For small events, organizers can mark all participants as present in one action. This is useful when QR scanning is impractical. The system prompts for confirmation before bulk marking and records that attendance was marked in bulk rather than individually verified.

### 6.3 Attendance Verification

#### Late Arrivals

The system allows check-in during the event and for a grace period after end time (configurable, typically 30 minutes). Late check-ins are flagged with arrival time. Organizers can set policies for late arrival certificate eligibility.

#### Check-Out System (Optional)

For long events or workshops, organizers can enable check-out requirements. Participants must scan their QR code when leaving. This calculates actual attendance duration and helps verify full participation for certificate eligibility.

### 6.4 Post-Event Attendance

#### Attendance Records

After event completion, attendance data becomes part of user's permanent record. Students can view their attendance history showing all events attended with dates and durations. This data is useful for:
- Personal participation tracking
- Certificate eligibility verification
- Scholarship and award applications
- Academic credit documentation

#### Attendance Analytics

Organizers access detailed attendance analytics:
- Total attendance vs. registered percentage
- On-time vs. late arrivals
- No-show analysis
- Department-wise attendance breakdown
- Historical attendance trends for similar events

#### No-Show Management

Users with excessive no-shows may face restrictions:
- Warning notifications after multiple no-shows
- Temporary registration restrictions
- Priority given to users with good attendance records
- No-show reports visible to admins for policy enforcement

---

## 7. Certificate Generation

### 7.1 Certificate System

#### Certificate Eligibility

Certificates are awarded based on configurable criteria:
- Attendance requirement (must have checked in)
- Minimum participation duration (if check-out enabled)
- Event completion status
- Feedback submission (optional requirement)
- No policy violations during event

#### Certificate Templates

Administrators create reusable certificate templates with placeholders for dynamic content:

**Template Elements**:
- Institution logo and header
- Certificate title and text
- Participant name placeholder `{{PARTICIPANT_NAME}}`
- Event name placeholder `{{EVENT_NAME}}`
- Event date placeholder `{{EVENT_DATE}}`
- Organizer signature section
- Certificate ID and QR code for verification
- Institution seal or watermark

**Template Formats**:
- PDF format (preferred for professional certificates)
- Image format (PNG with high resolution)
- Customizable dimensions (A4, Letter size)

### 7.2 Certificate Generation Process

#### Automated Generation

After event completion and attendance verification, the system automatically generates certificates for eligible participants:

**Step 1**: Verify attendance and eligibility criteria

**Step 2**: Fetch certificate template for the event

**Step 3**: Replace placeholders with participant details

**Step 4**: Generate unique certificate ID

**Step 5**: Add verification QR code (links to certificate verification page)

**Step 6**: Upload certificate PDF to Firebase Storage

**Step 7**: Update registration document with certificate URL

**Step 8**: Send notification to participant with download link

#### Manual Generation

Organizers can manually trigger certificate generation for individual participants or generate in bulk. This is useful for re-issuing lost certificates or generating for late attendees added manually.

### 7.3 Certificate Distribution

#### Download Access

Participants access certificates from their "My Registrations" section. Each attended event with certificate availability shows a "Download Certificate" button. Certificates are also accessible from the event details page under "My Certificate" tab.

#### Certificate Sharing

Users can share certificates directly from the app to social media, email, or save to device storage. A watermarked preview is available before downloading the full certificate to prevent unauthorized sharing.

### 7.4 Certificate Verification

#### Public Verification System

A web-based verification portal allows anyone to verify certificate authenticity:

**Verification Process**:
1. Enter certificate ID or scan QR code from certificate
2. System looks up certificate in database
3. Display verification results showing:
   - Participant name
   - Event name and date
   - Issuing institution
   - Issue date
   - Verification status (Valid/Invalid)
   - Warning for expired or revoked certificates

#### Revocation System

Administrators can revoke certificates if issued in error or due to policy violations. Revoked certificates are marked in the database and verification shows "Revoked" status with reason.

---

## 8. Registration Analytics

### 8.1 Registration Metrics

#### Real-Time Statistics

Organizers monitor registration progress with live dashboards showing:
- Current registration count vs. capacity
- Registration rate (per hour/day)
- Waitlist size
- Cancellation rate
- Approval pending count

#### Registration Timeline

A line graph visualizes registration trends over time from opening to closing date. This helps identify:
- Peak registration periods
- Impact of promotional activities
- Early registration vs. last-minute registrations
- Effect of reminder notifications

### 8.2 Participant Demographics

#### Demographic Breakdown

Charts display registration distribution by:
- Department (pie chart)
- Academic year (bar chart)
- User role (students vs. faculty)
- Registration source (browse, search, notification)

#### Historical Comparisons

For recurring events, the system compares current registration with previous occurrences:
- Registration pace comparison
- Audience composition changes
- Attendance rate trends
- Popular time slots or dates

### 8.3 Conversion Metrics

#### Registration Funnel

Track user journey from event view to completed registration:
- Event views count
- Registration form started
- Form completed and submitted
- Approval conversion (if applicable)
- Attendance conversion

#### Drop-Off Analysis

Identify where users abandon the registration process:
- Form field completion rates
- Custom field response rates
- Terms acceptance abandonment
- Payment drop-offs (if paid events)

---

## 9. Integration Features

### 9.1 Calendar Integration

#### Export to Calendar

Users add events to their device calendar with one tap. The system generates .ics (iCalendar) files containing:
- Event title and description
- Date, time, and duration
- Venue/location
- Reminder settings (customizable)
- Organizer contact information
- Event URL (deep link to app)

#### Calendar Sync

Optional feature to sync all registered events to device calendar automatically. Users control sync preferences in settings. Updates to event details trigger calendar entry updates.

### 9.2 Email Integration

#### Registration Emails

Automated emails sent for registration lifecycle events:
- Confirmation email with details and QR code
- Approval notification (approved/rejected)
- Waitlist promotion notification
- Event reminder emails (24h, 1h before)
- Event update notifications
- Certificate availability notification

#### Email Templates

Customizable HTML email templates maintain consistent branding. Templates include institution logo, color scheme, and footer with contact information and social links.

### 9.3 External Systems

#### Export Registration Data

Organizers export participant lists in multiple formats:
- CSV (for Excel, Google Sheets)
- Excel (.xlsx) with formatted columns
- PDF (formatted participant list)
- JSON (for programmatic access)

#### API Access

Cloud Functions expose secure API endpoints for external systems to:
- Query registration status
- Submit registrations programmatically
- Retrieve attendance data
- Access event information

---

## 10. Security and Privacy

### 10.1 Registration Data Security

#### Data Protection

Sensitive registration data is protected through:
- Firestore security rules restricting read access
- Encrypted data transmission (HTTPS only)
- Personal information visible only to authorized users
- Automatic data anonymization for analytics

#### Access Control

Different roles have different data access levels:
- Students: Own registrations only
- Organizers: Registrations for their events only
- Admins: Full access with audit logging
- QR scanners: Attendance marking only, no personal data

### 10.2 Privacy Compliance

#### Data Minimization

The system collects only necessary information for registration purposes. Optional fields are clearly marked. Users control visibility of their participation (public, friends only, private).

#### Data Retention

Registration data is retained according to institution policy:
- Active registrations: Indefinitely while event exists
- Cancelled registrations: 30 days then archived
- Attendance records: Permanent (for academic records)
- Personal contact info: Removed after graduation (configurable)

#### User Rights

Users can exercise data rights through app settings:
- View all collected data
- Download personal data (GDPR export)
- Request data deletion (with limitations for academic records)
- Opt-out of analytics tracking

---
